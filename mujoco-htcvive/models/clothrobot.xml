<mujoco>
    <compiler angle="radian" meshdir="meshes/" />

    <option timestep="0.000001" solver='Newton' impratio='5' cone='elliptic'>
        <flag warmstart="enable"/>
    </option>

    <include file="robots/sawyer/floatinggripper_shared.xml"/>
    <include file="robots/sawyer/floatinggripper_actuator_left.xml"/>
    <include file="robots/sawyer/floatinggripper_actuator_right.xml"/>
    <include file="scenes/scene.xml"/>

    <worldbody>
        <include file="robots/sawyer/floatinggripper_left.xml"/>
        <include file="robots/sawyer/floatinggripper_right.xml"/>

        <body name="mocap0" mocap="true" pos="0 -1.11 1.5" euler="0 0 0">
            <geom conaffinity="0" contype="0" group="1" mesh="l6" rgba="0.5 0.1 0.1 0.5" type="mesh" euler="0 3.14 0" solref='0.0001 1' solimp='0.99 0.99 0.01'/>
        </body>

        <body name="mocap1" mocap="true" pos="-1 -1.11 1.5" euler="0 0 0">
            <geom conaffinity="0" contype="0" group="1" mesh="l6" rgba="0.5 0.1 0.1 0.5" type="mesh" euler="0 3.14 0" solref='0.0001 1' solimp='0.99 0.99 0.01'/>
        </body>


        <body name="Cloth_B3_5" pos="-0.25 0.3 0.1">
            <freejoint name="Cloth_ref"/>
            <composite prefix="Cloth_" count="9 9 1" spacing="0.025" type="cloth" flatinertia="0.1" offset="0 0 1">
                <joint stiffness="0.02" damping="0.005" kind="main"/>
                <!-- adding stiffness is primarily what enables folding. increased stiffness means easier to fold, but more carpetlike -->
                <!-- <joint kind="twist"/> -->
                <!-- enabling twist joint makes inertial matrix freak out. including this might be good, but unsure of parameters to pick to enable non-buggy sim. -->
                <!-- <joint kind="stretch" stiffness="0.0001"/> -->
                <!-- playing with stretch joint might be helpful for making it behave less like a carpet when it is stiff -->
                <!-- <skin material="matcarpet" texcoord="true" inflate="0.005" subgrid="3"/> -->
                <geom rgba=".8 .2 .1 1" size=".01 .005" type="capsule"/>
                <!-- adding friction to geom might be a good way to make the material less like a silky, slippery carpet /-->

            </composite>
            <!-- <geom type="box" size=".01 .01 .01" rgba="0 .9 0 1"/> -->

        </body>

        <!-- <composite type="grid" count="9 9 1" spacing="0.05" offset="0 0 1">
            <skin material="matcarpet" inflate="0.001" subgrid="3" texcoord="true"/>
            <geom size=".02"/>
            <pin coord="0 0"/>
            <pin coord="8 0"/>
        </composite> -->


        <body name="boxa" pos="-0.25 0.3 0.3">
            <joint type="free"/>
            <geom type="box" size=".01 .01 .01" rgba="0 .9 0 1"/>
        </body>


    </worldbody>


    <equality>
        <weld name="weldmocap" body1="mocap0" body2="r_arm_l6" solref="0.0001 1" solimp=".99 .99 0.01"/>
        <weld name="weldmocap2" body1="mocap1" body2="l_arm_l6" solref="0.0001 1" solimp=".99 .99 0.01"/>
        <!-- <connect body1="B3_5" body2="l_arm_l6" anchor="0 0 0" solref="0.01 1" solimp="0.99 0.99 0.01"/>
        <weld body1="B3_5" body2="l_arm_l6" solref="0.01 1" solimp="0.99 0.99 0.01"/> -->
        <!-- <connect body1="testbox" body2="Cloth_B3_5" anchor="0 0 0" solref="0.01 1" solimp="0.99 0.99 0.01"/> -->
        <!-- <weld body1="boxa" body2="boxb" solref="0.01 1" solimp="0.99 0.99 0.01"/> -->
        <!-- <connect body1="l_finger_l" body2="testbox" anchor="0.1 0.1 0.1" solref="0.01 1" solimp="0.99 0.99 0.01"/> -->
        <!-- <weld name="weld1" body1="testbox" body2="Cloth_B3_5" relpose="0 1 0 0 0 0 0" solref="0.0001 1" solimp="0.99 0.99 0.01"/> -->
        <!-- <joint joint1="Cloth_J1_8_8" joint2="l_gripper_jl" polycoef="0 1 0 0 0"/> -->
        <!-- <weld name="weldbox" body1="Cloth_B0_1" body2="boxa" relpose="0 0 0 1 0 0 0" active="true" solref="0.0001 1" solimp=".99 .99 0.01"/> -->
        <!-- <weld name="weldarm" body1="l_arm_gripper_base" body2="Cloth_B0_1" relpose="0 0 0.5 1 0 0 0" active="true" solref="0.0001 1" solimp=".99 .99 0.01"/> -->
        <!-- <weld name="weldboxx" body1="boxb" body2="boxa"/> -->

        <!-- <weld name="weldrope" body1="l_arm_gripper_base" body2="Rope_B7" relpose="0 0 0.21 1 0 0 0" active="false" solref="0.0001 1" solimp=".99 .99 0.01"/> -->
        <weld name="weldcloth_a" body1="l_arm_gripper_base" body2="boxa" relpose="0 0 0.15 1 0 0 0" active="false" solref="0.0001 1" solimp=".99 .99 0.01"/>
        <weld name="weldbox" body1="boxa" body2="Cloth_B0_0" relpose="0 0 0 1 0 0 0" active="true" solref="0.0001 1" solimp=".99 .99 0.01"/>
        <!-- <weld name="weldcloth_a" body1="l_arm_gripper_base" body2="Cloth_B0_0" relpose="0 0 0.25 1 0 0 0" active="false" solref="0.0001 1" solimp=".99 .99 0.01"/> -->

        <!-- <weld name="weldcloth_b" body1="r_arm_gripper_base" body2="Cloth_B8_8" relpose="0 0 0.21 1 0 0 0" active="false" solref="0.0001 1" solimp=".99 .99 0.01"/> -->
    </equality>
</mujoco>